--

## π“ **λ°±μ—”λ“ μ‚¬μ©λ²•**

μ΄ λ¬Έμ„λ” **NFT κ²€μ¦ API** λ° κ΄€λ ¨ λ°±μ—”λ“ μ‹μ¤ν…μ μ‚¬μ©λ²•μ„ μ„¤λ…ν•©λ‹λ‹¤. μ΄ APIλ” μ‚¬μ©μμ νΈλμ­μ…μ„ κ²€μ¦ν•κ³ , ν•΄λ‹Ή νΈλμ­μ…μ΄ λΈ”λ΅μ— ν¬ν•¨λμ—λ”μ§€, NFTκ°€ μ „μ†΅λμ—λ”μ§€ μ—¬λ¶€λ¥Ό ν™•μΈν•λ” κΈ°λ¥μ„ μ κ³µν•©λ‹λ‹¤.

---

### 1. **μ‹μ‘ν•κΈ°**

#### **1.1. ν•„μ”ν• λ„κµ¬ μ„¤μΉ**

λ°±μ—”λ“ μ„λ²„λ” **Node.js**μ™€ **Docker**λ¥Ό μ‚¬μ©ν•μ—¬ μ‹¤ν–‰λ©λ‹λ‹¤. ν•„μ”ν• λ„κµ¬κ°€ μ—†λ‹¤λ©΄, λ¨Όμ € μ„¤μΉν•΄μ•Ό ν•©λ‹λ‹¤.

* **Node.js μ„¤μΉ**:

  * [Node.js λ‹¤μ΄λ΅λ“](https://nodejs.org/) ν›„ μ„¤μΉ
  * μ„¤μΉκ°€ μ™„λ£λλ©΄, `node -v`μ™€ `npm -v`λ¥Ό ν†µν•΄ μ„¤μΉλ λ²„μ „μ„ ν™•μΈν•  μ μμµλ‹λ‹¤. (v22.19.0 κ¶μ¥)
* **Docker μ„¤μΉ**:

  * [Docker λ‹¤μ΄λ΅λ“](https://www.docker.com/products/docker-desktop) ν›„ μ„¤μΉ
  * μ„¤μΉκ°€ μ™„λ£λλ©΄, `docker --version`κ³Ό `docker-compose --version`μ„ ν†µν•΄ μ„¤μΉλ λ²„μ „μ„ ν™•μΈν•  μ μμµλ‹λ‹¤.

#### **1.2. ν”„λ΅μ νΈ ν΄λ΅ **

λ¨Όμ € ν”„λ΅μ νΈλ¥Ό ν΄λ΅ ν•©λ‹λ‹¤. ν„°λ―Έλ„μ—μ„ μ•„λ λ…λ Ήμ–΄λ¥Ό μ…λ ¥ν•μ„Έμ”:

```bash
git clone <ν”„λ΅μ νΈ URL>
cd <ν”„λ΅μ νΈ ν΄λ”>
```

#### **1.3. μμ΅΄μ„± μ„¤μΉ**

ν”„λ΅μ νΈ λ””λ ‰ν† λ¦¬μ—μ„ μ•„λ λ…λ Ήμ–΄λ΅ μμ΅΄μ„± ν¨ν‚¤μ§€λ¥Ό μ„¤μΉν•©λ‹λ‹¤: (backend ν΄λ” λ‚΄μ—μ„)

```bash
npm install
```

---

### 2. **λ„μ»¤ μ„¤μ •**

μ΄ ν”„λ΅μ νΈλ” **Docker**μ™€ **Docker Compose**λ¥Ό μ‚¬μ©ν•μ—¬ ν™κ²½μ„ μ„¤μ •ν•©λ‹λ‹¤.

#### **2.1. Docker Composeλ΅ ν™κ²½ μ‹¤ν–‰**

Docker Composeλ¥Ό ν†µν•΄ μ—¬λ¬ μ»¨ν…μ΄λ„λ¥Ό ν• λ²μ— μ‹¤ν–‰ν•  μ μμµλ‹λ‹¤. μ•„λ λ…λ Ήμ–΄λ΅ Docker Composeλ¥Ό μ‹¤ν–‰ν•μ„Έμ”:

```bash
docker-compose up -d
```

`-d` μµμ…μ€ λ°±κ·ΈλΌμ΄λ“μ—μ„ μ‹¤ν–‰λλ„λ΅ ν•©λ‹λ‹¤.

#### **2.2. μ»¨ν…μ΄λ„ ν™•μΈ**

μ‹¤ν–‰ μ¤‘μΈ μ»¨ν…μ΄λ„λ¥Ό ν™•μΈν•λ ¤λ©΄ μ•„λ λ…λ Ήμ–΄λ¥Ό μ…λ ¥ν•©λ‹λ‹¤:

```bash
docker ps
```

---

### 3. **μ„λ²„ μ‹¤ν–‰**

#### **3.1. μ„λ²„ μ‹¤ν–‰ ν™•μΈ**

λ„μ»¤μ™€ npm μ„¤μ •μ΄ μ™„λ£λλ©΄, μ•„λ λ…λ Ήμ–΄λ΅ μ„λ²„κ°€ μ •μƒμ μΌλ΅ μ‹¤ν–‰λλ”μ§€ ν™•μΈν•  μ μμµλ‹λ‹¤:

```bash
docker-compose up -d
```

λ„μ»¤ Composeκ°€ μ μ‘λ™ν•λ©΄ μ„λ²„κ°€ λ°±κ·ΈλΌμ΄λ“μ—μ„ μ‹¤ν–‰λ©λ‹λ‹¤.

#### **3.2. μ„λ²„ λ΅κ·Έ ν™•μΈ**

μ„λ²„μ λ΅κ·Έλ¥Ό ν™•μΈν•λ ¤λ©΄, μ•„λ λ…λ Ήμ–΄λ¥Ό μ‚¬μ©ν•μ„Έμ”:

```bash
docker-compose logs
```

λλ” νΉμ • μ„λΉ„μ¤λ¥Ό ν™•μΈν•λ ¤λ©΄:

```bash
docker-compose logs <μ„λΉ„μ¤ μ΄λ¦„>
```

---

### 4. **API μ”μ²­ λ° ν…μ¤νΈ**

#### **4.1. Postmanμ„ ν†µν• API ν…μ¤νΈ**

Postmanμ„ μ‚¬μ©ν•μ—¬ APIλ¥Ό ν…μ¤νΈν•  μ μμµλ‹λ‹¤. `POST /verify-tx` μ—”λ“ν¬μΈνΈλ¥Ό μ‚¬μ©ν•μ—¬ νΈλμ­μ…μ„ κ²€μ¦ν•  μ μμµλ‹λ‹¤.

* **URL**: `http://localhost:4000/api/verify-tx`
* **HTTP λ©”μ†λ“**: `POST`
* **Body**:

  ```json
  {
    "txHash": "0xfc63cac02b6988f3b35bcfb0d0df1ec201b7d15b33d7148f41e7db70d7da5d06"
  }
  ```

#### **4.2. μ‘λ‹µ μμ‹**

* **μ„±κ³µμ μΈ νΈλμ­μ…**:

  ```json
  {
    "ok": true,
    "state": "CONFIRMED_SUCCESS",
    "blockNumber": 9492127
  }
  ```

* **μ‹¤ν¨ν• νΈλμ­μ…**:

  ```json
  {
    "ok": false,
    "state": "CONFIRMED_FAILED",
    "blockNumber": 9492127
  }
  ```

* **μμμ¦μ„ μ°Ύμ„ μ μ—†λ” κ²½μ°**:

  ```json
  {
    "ok": false,
    "state": "NO_RECEIPT"
  }
  ```

* **νΈλμ­μ…μ„ μ°Ύμ„ μ μ—†λ” κ²½μ°**:

  ```json
  {
    "ok": false,
    "state": "TX_NOT_FOUND"
  }
  ```

---

### 5. **λ¬Έμ  ν•΄κ²°**

#### **5.1. νΈλμ­μ… κ²€μ¦ μ‹¤ν¨**

νΈλμ­μ… κ²€μ¦μ΄ μ‹¤ν¨ν•κ±°λ‚ "NO_RECEIPT" μƒνƒκ°€ λ°ν™λ  κ²½μ°, νΈλμ­μ… ν•΄μ‹κ°€ μλ»λμ—κ±°λ‚ λ„¤νΈμ›ν¬μ— ν¬ν•¨λμ§€ μ•μ€ νΈλμ­μ…μΌ μ μμµλ‹λ‹¤. λ‹¤μ‹ ν• λ² νΈλμ­μ… ν•΄μ‹λ¥Ό ν™•μΈν•΄ λ³΄μ„Έμ”.

#### **5.2. μ„λ²„ μ—λ¬**

μ„λ²„κ°€ μμƒν• λ€λ΅ μ‘λ™ν•μ§€ μ•λ” κ²½μ°, λ„μ»¤ λ΅κ·Έλ¥Ό ν™•μΈν•μ—¬ μ¤λ¥ λ©”μ‹μ§€λ¥Ό μ κ²€ν•μ‹­μ‹μ¤.

```bash
docker-compose logs
```

#### **5.3. API μ‘λ‹µ μƒνƒ μ½”λ“**

* `200 OK`: μ”μ²­μ΄ μ„±κ³µμ μΌλ΅ μ²λ¦¬λ¨.
* `400 Bad Request`: μλ»λ μ”μ²­, μλ¥Ό λ“¤μ–΄ νΈλμ­μ… ν•΄μ‹ λ„λ½.
* `500 Internal Server Error`: μ„λ²„ λ‚΄λ¶€ μ¤λ¥. μ„λ²„ λ΅κ·Έλ¥Ό ν™•μΈν•μ„Έμ”.

---


---

## π§© NFT(ERC-1155) λ³΄μ  κ²€μ¦ API

### 1. **μ”μ²­**

#### **1.1. URL**

* **Endpoint**: `POST /api/verify-1155`
* **μ„¤λ…**: νΉμ • μ§€κ°‘ μ£Όμ†κ°€ μ§€μ •λ ERC-1155 NFTλ¥Ό λ³΄μ ν•κ³  μλ”μ§€ κ²€μ¦ν•©λ‹λ‹¤.

#### **1.2. μ”μ²­ ν•μ‹ (Request Body)**

```json
{
  "wallet_addr": "0x128a63c8279bc447c7a5574ff478b28d59c22b50",
  "nft_addr": "0x7428A5Eec110bE1631e2FefAB424D7a2b71D8ed2",
  "nft_id": 1
}
```

#### **1.3. ν•„λ“ μ„¤λ…**

| ν•„λ“λ…           | νƒ€μ…                   |  ν•„μ | μ„¤λ…                        |
| :------------ | :------------------- | :-: | :------------------------ |
| `wallet_addr` | `string`             |  β…  | λ³΄μ  μ—¬λ¶€λ¥Ό ν™•μΈν•  μ§€κ°‘ μ£Όμ†          |
| `nft_addr`    | `string`             |  β…  | NFT(ERC-1155) μ¤λ§νΈ μ»¨νΈλ™νΈ μ£Όμ† |
| `nft_id`      | `number` or `string` |  β…  | NFTμ κ³ μ  Token ID          |

---

### 2. **μ‘λ‹µ**

#### **2.1. μ„±κ³µμ μΌλ΅ NFTλ¥Ό λ³΄μ ν• κ²½μ°**

```json
{
  "ok": true,
  "reason": "OK",
  "owned": true,
  "standard": "ERC1155",
  "blockTag": "latest"
}
```

> π’΅ ν•΄λ‹Ή μ§€κ°‘μ΄ ν•΄λ‹Ή NFT(`nft_id`)λ¥Ό **1κ° μ΄μƒ λ³΄μ  μ¤‘**μ„μ„ μλ―Έν•©λ‹λ‹¤.

---

#### **2.2. NFTλ¥Ό λ³΄μ ν•μ§€ μ•μ€ κ²½μ°**

```json
{
  "ok": false,
  "reason": "ZERO_BALANCE",
  "owned": false,
  "standard": "ERC1155",
  "blockTag": "latest"
}
```

> β οΈ ν•΄λ‹Ή μ§€κ°‘ μ£Όμ†κ°€ NFTλ¥Ό λ³΄μ ν•μ§€ μ•μ€ κ²½μ°μ…λ‹λ‹¤.

---

#### **2.3. μλ»λ λ„¤νΈμ›ν¬ μ²΄μΈμ— μ—°κ²°λ κ²½μ°**

```json
{
  "ok": false,
  "reason": "WRONG_CHAIN(0xaa36a7)"
}
```

> β οΈ `.env` νμΌμ— μ„¤μ •λ `EXPECTED_CHAIN_ID`μ™€ ν„μ¬ RPC λ„¤νΈμ›ν¬μ μ²΄μΈ IDκ°€ λ‹¤λ¥Ό λ• λ°μƒν•©λ‹λ‹¤.
> μ: `EXPECTED_CHAIN_ID=0xaa36a7` (Sepolia)

---

#### **2.4. μ»¨νΈλ™νΈκ°€ μ΅΄μ¬ν•μ§€ μ•λ” κ²½μ°**

```json
{
  "ok": false,
  "reason": "NOT_A_CONTRACT"
}
```

> β οΈ `nft_addr`κ°€ μ‹¤μ  μ¤λ§νΈ μ»¨νΈλ™νΈ μ£Όμ†κ°€ μ•„λ‹ λ• λ°μƒν•©λ‹λ‹¤.

---

#### **2.5. ERC-1155 ν‘μ¤€μ΄ μ•„λ‹ κ²½μ°**

```json
{
  "ok": false,
  "reason": "NOT_ERC1155"
}
```

> β οΈ ν•΄λ‹Ή μ£Όμ†κ°€ ERC-1155 μΈν„°νμ΄μ¤(`0xd9b67a26`)λ¥Ό μ§€μ›ν•μ§€ μ•λ” κ²½μ° λ°μƒν•©λ‹λ‹¤.

---

#### **2.6. μ„λ²„ μ¤λ¥**

```json
{
  "ok": false,
  "error": "Internal Server Error"
}
```

> β μ„λ²„ λ‚΄λ¶€ μ¤λ¥ λ°μƒ μ‹ λ°ν™λ©λ‹λ‹¤.
> λ΅κ·Έλ¥Ό ν†µν•΄ RPC μ—°κ²° λλ” ABI νΈμ¶ μ¤λ¥λ¥Ό ν™•μΈν•΄μ•Ό ν•©λ‹λ‹¤.

---

### 3. **μ„λ²„ ν™κ²½ λ³€μ (.env)**

`.env` νμΌμ— λ‹¤μ λ³€μλ¥Ό μ„¤μ •ν•΄μ•Ό ν•©λ‹λ‹¤.

```bash
# RPC μ—°κ²°μ© (μ: Infura, Alchemy, λλ” BlockPi)
RPC_URL=https://sepolia.infura.io/v3/<YOUR_API_KEY>

# κ²€μ¦ λ€μƒ μ²΄μΈ ID (μ: Sepolia)
EXPECTED_CHAIN_ID=0xaa36a7
```

---
### 4. **μ‘λ‹µ μƒνƒ μ½”λ“ μ”μ•½**

| μƒνƒ μ½”λ“   | μλ―Έ                                              |
| ------- | ----------------------------------------------- |
| **200** | μ”μ²­ μ„±κ³µ, κ²€μ¦ κ²°κ³Ό λ°ν™                                 |
| **400** | ν•„μ μ…λ ¥κ°’ λ„λ½ (`wallet_addr`, `nft_addr`, `nft_id`) |
| **500** | μ„λ²„ λ‚΄λ¶€ μ¤λ¥ λλ” RPC νΈμ¶ μ‹¤ν¨                           |

---

### β… **μ •λ¦¬**

| κ²€μ¦ λ‹¨κ³„       | μ„±κ³µ μ‹ | μ‹¤ν¨ μ‹             |
| ----------- | ---- | ---------------- |
| RPC μ²΄μΈ μ—°κ²°   | `OK` | `WRONG_CHAIN`    |
| μ»¨νΈλ™νΈ ν™•μΈ     | `OK` | `NOT_A_CONTRACT` |
| ERC-1155 μ§€μ› | `OK` | `NOT_ERC1155`    |
| NFT λ³΄μ       | `OK` | `ZERO_BALANCE`   |

---